TODO:
    - Create _step functions to resolve phases
